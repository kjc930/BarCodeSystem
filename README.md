# PLC 기반 바코드 시스템

## 시스템 개요

이 시스템은 PLC, 시리얼 바코드 스캐너, 시리얼 바코드 프린터를 연동하여 자동화된 바코드 처리 시스템입니다.

### 주요 기능
- PLC 신호 모니터링 (M100, M101, M200, M201)
- LH/RH 화면 분할 모니터링
- 바코드 스캔 및 검증
- 자동 바코드 출력
- 공정번호와 제품코드 매칭

## 시스템 흐름

1. **PLC 신호 모니터링**
   - M100: LH 완료 신호 (0→1)
   - M101: RH 완료 신호 (0→1)
   - M200: LH 공정번호
   - M201: RH 공정번호

2. **바코드 스캔 및 검증**
   - 시리얼 스캐너로 부품 바코드 스캔
   - 기본 설정된 부품 바코드와 매칭
   - LH/RH 부품 구분

3. **바코드 출력**
   - 공정번호에 따른 제품코드 생성
   - 시리얼 프린터로 바코드 출력

## 설치 및 설정

### 1. 가상환경 설정
```bash
python -m venv .venv
.venv\Scripts\activate  # Windows
```

### 2. 패키지 설치
```bash
pip install -r requirements.txt
```

### 3. 설정 파일 수정
`Program/config.json` 파일에서 다음 설정을 수정하세요:

```json
{
    "plc": {
        "port": "COM1",        // PLC 연결 포트
        "baudrate": 9600       // 통신 속도
    },
    "barcode_scanner": {
        "port": "COM2"         // 스캐너 연결 포트
    },
    "barcode_printer": {
        "port": "COM3"         // 프린터 연결 포트
    }
}
```

## 실행 방법

```bash
cd Program
python barcode.py
```

## 시스템 구성

### PLC 메모리 맵
- **M100**: LH 완료 신호 (0=대기, 1=완료)
- **M101**: RH 완료 신호 (0=대기, 1=완료)
- **M200**: LH 공정번호
- **M201**: RH 공정번호

### 공정 매칭 테이블
- 공정1 → 891101-R2201 (LH)
- 공정2 → 891102-R2201 (LH)
- 공정3 → 892101-R2201 (RH)
- 공정4 → 892102-R2201 (RH)

### 부품 바코드 형식
- LH 부품: 8911XX-XXXXX
- RH 부품: 8921XX-XXXXX

## UI 구성

### LH 패널 (Left Hand)
- 상태 표시 (대기중/완료)
- 공정번호 표시
- 제품코드 표시
- 바코드 스캔 로그
- 바코드 출력 버튼

### RH 패널 (Right Hand)
- LH와 동일한 구성

### 시스템 상태 패널
- PLC 연결 상태
- 스캐너 연결 상태
- 프린터 연결 상태
- 최근 스캔된 바코드

## 문제 해결

### PLC 연결 실패
1. COM 포트 번호 확인
2. 통신 속도 설정 확인
3. PLC 전원 및 케이블 연결 확인

### 바코드 스캔 안됨
1. 스캐너 전원 확인
2. COM 포트 설정 확인
3. 스캐너 드라이버 설치 확인

### 바코드 출력 안됨
1. 프린터 전원 및 용지 확인
2. COM 포트 설정 확인
3. 프린터 명령어 형식 확인

## 개발 정보

- **언어**: Python 3.12
- **GUI**: PyQt5
- **PLC 통신**: Modbus RTU
- **시리얼 통신**: pyserial
- **바코드 처리**: pyzbar, qrcode

## 라이선스

이 프로젝트는 내부 사용을 위한 시스템입니다.
